<!DOCTYPE html>
<html>
<body>
<canvas id="canvas" style="border:1px solid #000000"></canvas> 


<script>
//------Vars--------
//Canvas Vars
var cwidth=300;
var cheight=300;
var c = document.getElementById("canvas");
var ctx = c.getContext("2d");


//Lemming Vars
var size = 5;
var entx=cwidth/2;
var enty=cheight/2;
var gravity = size;


//Game Vars
var maxPop = 5; 
var a = new Array(maxPop);
var e = new entrance(entx,enty);
var time = 0;


//Objects
function lemming(x,y, direction){
   this.x= x;
   this.y= y;
   this.direction = direction;

   this.turnAround = function(){
      if (this.direction=="LEFT") this.direction = "RIGHT";
      else this.direction = "LEFT";
   }

   this.move = function(){
      if (this.y <= (cheight-size*2))  this.fall();

      else {
      if (this.direction=="LEFT"){
         this.x--; 
               }
      else if (this.direction=="RIGHT"){
         this.x++;

      }
      if(this.x >= (cwidth-size) || this.x <= size) this.turnAround();

      }

   }
   
   this.fall = function(){
      this.y += gravity; 
   }

   this.draw = function(){
      drawCircle(this.x,this.y,size);
   }

   this.update = function(){
      this.draw();
   }
}

// Entrance
function entrance(x,y){
   var x = x;
   var y = y; 
   var w = size*3;
   var h = size*3;

   this.draw = function(){
       drawRect(x-w/2,y-h/2,w,h);
   }
}

// Init 
function init(){
   canvas.width = cwidth;
   canvas.height = cheight;
}



// --------Functions ----
function drawCircle(x,y,size){
   ctx.beginPath();
   ctx.arc(x,y,size,0,2*Math.PI);
   ctx.stroke();
   ctx.fillStyle = "#0000FF";
   ctx.fill();
   
} 


function drawRect(x,y,width, height){
    ctx.rect(x,y,width,height);
    ctx.fillStyle = "#FF0000";
    ctx.fill();
    ctx.stroke(); 
    
}


function clear(){
   ctx.clearRect(0, 0, cwidth, cheight);
}


function update(){
   clear();

   e.draw();
    for (var i = 0; i < a.length; i++)  
     if (a[i] !=null)a[i].update();
}

function moveLemmings(){
    for (var i = 0; i < a.length; i++)  
       if (a[i] !=null) a[i].move();
}

function spawnLemmings(){
    for (var i = 0; i < a.length; i++)  
       if (time == 100*i) a[i] = new lemming(entx,enty,"RIGHT");
}

function gameLoop(){   
   spawnLemmings();

   moveLemmings();

   update();
   time ++; 
}

// ---------MAIN PROGRAM ---------
init();
setInterval(gameLoop, 30);
</script>

</body>
</html> 
